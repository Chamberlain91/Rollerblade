"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var merge=_interopDefault(require("deepmerge"));function __awaiter(e,r,t,o){return new(t||(t=Promise))(function(n,a){function i(e){try{u(o.next(e))}catch(e){a(e)}}function l(e){try{u(o.throw(e))}catch(e){a(e)}}function u(e){e.done?n(e.value):new t(function(r){r(e.value)}).then(i,l)}u((o=o.apply(e,r||[])).next())})}function __generator(e,r){var t,o,n,a,i={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(a){return function(l){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,o&&(n=o[2&a[0]?"return":a[0]?"throw":"next"])&&!(n=n.call(o,a[1])).done)return n;switch(o=0,n&&(a=[0,n.value]),a[0]){case 0:case 1:n=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,o=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(n=(n=i.trys).length>0&&n[n.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){i.label=a[1];break}if(6===a[0]&&i.label<n[1]){i.label=n[1],n=a;break}if(n&&i.label<n[2]){i.label=n[2],i.ops.push(a);break}n[2]&&i.ops.pop(),i.trys.pop();continue}a=r.call(e,i)}catch(e){a=[6,e],o=0}finally{t=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}}function __values(e){var r="function"==typeof Symbol&&e[Symbol.iterator],t=0;return r?r.call(e):{next:function(){return e&&t>=e.length&&(e=void 0),{value:e&&e[t++],done:!e}}}}var path=require("path"),rollup=require("rollup"),typescript=require("rollup-plugin-typescript2"),sourcemaps=require("rollup-plugin-sourcemaps"),commonjs=require("rollup-plugin-commonjs"),minify=require("rollup-plugin-babel-minify"),json=require("rollup-plugin-json"),cacheRoot=path.join(path.resolve(__filename,process.cwd()),".cache");function rollerblade(e){return __awaiter(this,void 0,void 0,function(){var r,t,o,n,a,i,l,u,c,s,p;return __generator(this,function(f){switch(f.label){case 0:if(0!=e.length)return[3,1];throw new Error("Must specify at least one path to a file.");case 1:r=new Array,f.label=2;case 2:f.trys.push([2,8,9,10]),t=__values(e),o=t.next(),f.label=3;case 3:return o.done?[3,7]:(void 0===(n=o.value).format&&(n.format="es"),void 0===n.sourcemap&&(n.sourcemap=!1),void 0===n.tsconfig&&void 0===n.target&&(n.target="es5"),void 0!==n.target&&void 0!==n.tsconfig&&console.warn("Both target and tsconfig specified, target will be overriden by tsconfig."),console.log("Processing: "+n.input),a=path.parse(n.output||n.input),i=path.join(a.dir,a.name+".js.map"),l=path.join(a.dir,a.name+".js"),[4,rollup.rollup({input:n.input,treeshake:!0,plugins:[json(),typescript({cacheRoot:cacheRoot,useTsconfigDeclarationDir:!0,tsconfigDefaults:{compilerOptions:{moduleResolution:"node",target:n.target,lib:["es2018","es2017","es2016","es2015","dom"],declaration:!0,declarationDir:a.dir,allowSyntheticDefaultImports:!0,experimentalDecorators:!0,emitDecoratorMetadata:!0,downlevelIteration:!0,noImplicitReturns:!0,noImplicitThis:!0}},tsconfigOverride:merge(n.tsconfig||{},{compilerOptions:{sourceMap:n.sourcemap}})}),commonjs(),minify({comments:!1}),sourcemaps()]})]);case 4:return[4,f.sent().generate({format:n.format,sourcemapFile:i,sourcemap:n.sourcemap})];case 5:u=f.sent(),r.push({js:{file:l,content:u.code+(n.sourcemap?"//# sourceMappingURL=./"+a.name+".js.map":"")},map:n.sourcemap?{file:i,content:u.map}:void 0}),f.label=6;case 6:return o=t.next(),[3,3];case 7:return[3,10];case 8:return c=f.sent(),s={error:c},[3,10];case 9:try{o&&!o.done&&(p=t.return)&&p.call(t)}finally{if(s)throw s.error}return[7];case 10:return[2,r];case 11:return[2]}})})}module.exports=rollerblade;
